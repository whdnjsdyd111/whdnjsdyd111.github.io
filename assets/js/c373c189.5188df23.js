"use strict";(self.webpackChunkwyj_lab=self.webpackChunkwyj_lab||[]).push([[4194],{3905:(e,a,t)=>{t.d(a,{Zo:()=>o,kt:()=>d});var n=t(7294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function p(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?p(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},p=Object.keys(e);for(n=0;n<p.length;n++)t=p[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(n=0;n<p.length;n++)t=p[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=n.createContext({}),m=function(e){var a=n.useContext(i),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},o=function(e){var a=m(e.components);return n.createElement(i.Provider,{value:a},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},k=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,p=e.originalType,i=e.parentName,o=s(e,["components","mdxType","originalType","parentName"]),c=m(t),k=r,d=c["".concat(i,".").concat(k)]||c[k]||u[k]||p;return t?n.createElement(d,l(l({ref:a},o),{},{components:t})):n.createElement(d,l({ref:a},o))}));function d(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var p=t.length,l=new Array(p);l[0]=k;var s={};for(var i in a)hasOwnProperty.call(a,i)&&(s[i]=a[i]);s.originalType=e,s[c]="string"==typeof e?e:r,l[1]=s;for(var m=2;m<p;m++)l[m]=t[m];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}k.displayName="MDXCreateElement"},4676:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>p,metadata:()=>s,toc:()=>m});var n=t(7462),r=(t(7294),t(3905));const p={slug:"LoRA",title:"LoRA: Low-Rank Adaptation of Large Language Models",tags:["PEFT","Adapter"]},l=void 0,s={unversionedId:"Paper/NLP/PEFT/2023-09-06-LoRA",id:"Paper/NLP/PEFT/2023-09-06-LoRA",title:"LoRA: Low-Rank Adaptation of Large Language Models",description:"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 :",source:"@site/docs/Paper/NLP/PEFT/2023-09-06-LoRA.md",sourceDirName:"Paper/NLP/PEFT",slug:"/Paper/NLP/PEFT/LoRA",permalink:"/docs/Paper/NLP/PEFT/LoRA",draft:!1,editUrl:"https://github.com/whdnjsdyd111/whdnjsdyd111.github.io/tree/master/docs/docs/Paper/NLP/PEFT/2023-09-06-LoRA.md",tags:[{label:"PEFT",permalink:"/docs/tags/peft"},{label:"Adapter",permalink:"/docs/tags/adapter"}],version:"current",frontMatter:{slug:"LoRA",title:"LoRA: Low-Rank Adaptation of Large Language Models",tags:["PEFT","Adapter"]},sidebar:"tutorialSidebar",previous:{title:"Multitask Prompt Tuning Enables Parameter-Efficient Transfer Learning",permalink:"/docs/Paper/NLP/PEFT/Multitask Prompt Tuning"},next:{title:"Training language models to follow instructions with human feedback (+ ChatGPT)",permalink:"/docs/Paper/NLP/Text Generation/InstructGPT"}},i={},m=[],o={toc:m},c="wrapper";function u(e){let{components:a,...p}=e;return(0,r.kt)(c,(0,n.Z)({},o,p,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 : ",(0,r.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2106.09685.pdf"},"https://arxiv.org/pdf/2106.09685.pdf")),(0,r.kt)("h1",{id:"abstract"},"Abstract"),(0,r.kt)("p",null,"GPT-3 175B \uc758 \ud30c\ub77c\ubbf8\ud130\ub97c fine-tuning \ud558\uae30\uc5d0\ub294 \ub9e4\uc6b0 \ubd80\ub2f4."),(0,r.kt)("p",null,"\uc774\uc5d0 \uc800\uc790\ub294 ",(0,r.kt)("strong",{parentName:"p"},"Lo"),"w-",(0,r.kt)("strong",{parentName:"p"},"R"),"ank ",(0,r.kt)("strong",{parentName:"p"},"A"),"daptation, ",(0,r.kt)("strong",{parentName:"p"},"LoRA")," \uc81c\uc548"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"pre-trained model weights \ub97c freeze"),(0,r.kt)("li",{parentName:"ul"},"Transformer layer \uc5d0 trainable rank decomposition \uc744 \uc8fc\uc785"),(0,r.kt)("li",{parentName:"ul"},"downstream task \uc5d0 \ub300\ud55c trainable parameter \ub97c \ub9e4\uc6b0 \ud06c\uac8c \uc904\uc784")),(0,r.kt)("p",null,"Adam \uc73c\ub85c fine-tuning \ud55c GPT-3 175B \uc640 \ube44\uad50\ud558\uc5ec, LoRA \ub294 "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"trainable parameter \uc218\ub97c 10,000\ubc30 \uc904\uc774\uace0"),(0,r.kt)("li",{parentName:"ul"},"GPU \uba54\ubaa8\ub9ac \uc694\uad6c\uc0ac\ud56d 3\ubc30 \uc904\uc784"),(0,r.kt)("li",{parentName:"ul"},"RoBERTa, DeBERTa, GPT-2 \ubc0f GPT-3 \uc5d0\uc11c\ub3c4 \ub354 \uc88b\uc740 \uc131\ub2a5")),(0,r.kt)("hr",null),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"LoRA \ub294 adapter \uc640 \ub2ec\ub9ac, ",(0,r.kt)("strong",{parentName:"li"},"\ucd94\uac00\uc801\uc778 inference latency \uc5c6\uc74c")),(0,r.kt)("li",{parentName:"ul"},"language model (LM) \uc758 adaptation \uc5d0\uc11c rank-deficiency \uc5d0 \ub300\ud55c \uacbd\ud5d8\uc801 \uc5f0\uad6c \uc81c\uacf5\ud558\uc5ec LoRA \uc758 \ud6a8\uacfc \uc81c\uacf5")),(0,r.kt)("h1",{id:"1-introduction"},"1. Introduction"),(0,r.kt)("p",null,"\ubcf4\ud1b5 multiple downstream \uc5d0 \uc801\uc751\ud558\uae30 \uc704\ud574 \ud558\ub098\uc758 LLM \uc5d0 \uc758\uc874\ud55c\ub2e4."),(0,r.kt)("p",null,"task \uc5d0 adaptation \ud560 \ub54c \uc77c\ubc18\uc801\uc73c\ub85c ",(0,r.kt)("em",{parentName:"p"},"fine-tuning")," \uc744 \ud558\uc9c0\ub9cc, \ubaa8\ub4e0 \ud30c\ub77c\ubbf8\ud130\ub97c \ud6c8\ub828\ud558\ub294 \uac83\uc774 \ud070 \ub2e8\uc810\uc774\ub2e4."),(0,r.kt)("p",null,"\uc774\uc5d0, \uba87\uba87 \ud30c\ub77c\ubbf8\ud130\ub9cc adapting \ud558\uac70\ub098 new task \ub97c \uc704\ud55c \uc678\ubd80 \ubaa8\ub4c8\uc744 \ud559\uc2b5\ud558\ub294 \uc2dc\ub3c4\ub3c4 \uc788\ub2e4."),(0,r.kt)("p",null,"task \ub9c8\ub2e4 pre-trained model \uc5d0 \uc801\uc740 \uc218\uc758 task-specific parameter \ub97c \uc800\uc7a5\ud558\uace0 \ub85c\ub4dc\ud558\uc5ec, \ubaa8\ub378 \uc0ac\uc6a9 \uc2dc \ud6a8\uc728\uc774 \ud5a5\uc0c1\ud55c\ub2e4."),(0,r.kt)("p",null,"\ud558\uc9c0\ub9cc, depth \ud655\uc7a5\uc774\ub098 sequence \uae38\uc774\ub97c \uc904\uc774\ub294 \ub4f1 \ubaa8\ub378 \ud488\uc9c8\uacfc \ud6a8\uc728\uc131\uac04\uc758 trade-off \uc124\uc815\uc774 \ud798\ub4e4\ub2e4."),(0,r.kt)("p",null,"\uc800\uc790\ub294 \uc774\uc804 \uc5f0\uad6c\uc5d0\uc11c learned over-parameterized models \uc774 \uc0ac\uc2e4\uc740 low intrinsic dimension \uc5d0 \uc874\uc7ac\ud55c\ub2e4\ub294 \uac83\uc744 \ubcf4\uace0 \uc601\uac10\uc744 \ubc1b\uc558\ub2e4."),(0,r.kt)("p",null,'model adaptation \uc911 weight \uc758 \ubcc0\ud654\uac00 \ub0ae\uc740 "intrinsic rank" \ub97c \uac00\uc9c8 \uac83\uc774\ub77c\ub294 \uac00\uc124\uc744 \uae30\ubc18\uc73c\ub85c Low-Rank Adaptation (LoRA) approach \ub97c \uc81c\uc548'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"pre-trained weights \ub97c \uace0\uc815\ud55c \ucc44, model adaptation \uc911 dense layer \uc758 \ubcc0\ud654\uc5d0 \ub300\ud55c rank decomposition matrices \ub97c \ucd5c\uc801\ud654\ud558\uc5ec \uc2e0\uacbd\ub9dd\uc758 \uc77c\ubd80 dense layer \ub97c \uac04\uc811\uc801\uc73c\ub85c \ud559\uc2b5\ud558\uac8c \ud568"),(0,r.kt)("li",{parentName:"ul"},"\uc608\ub85c, GPT-3 175B \uc0ac\uc6a9 \uc2dc, LoRA \ub97c \uc0ac\uc6a9\ud558\uba74 low rank \ub294 full rank (",(0,r.kt)("span",{parentName:"li",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"d")),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"d")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"))))),") \uac00 12,288 \uc640 \uac19\uc544\ub3c4 \ucda9\ubd84"),(0,r.kt)("li",{parentName:"ul"},"\uc774\ub85c\uc368 LoRA \ub294 \uc800\uc7a5 \ubc0f \uacc4\uc0b0 \ud6a8\uc728\uc801")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Figure 1",src:t(3574).Z,width:"343",height:"412"})),(0,r.kt)("p",null,"LoRA \ud575\uc2ec \uc774\uc810"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"pre-trained model \uc740 \uc5ec\ub7ec task \uc5d0 \ub300\ud574, \ub9e4\uc6b0 \uc791\uc740 LoRA \ubaa8\ub4c8\uc744 \uad6c\ucd95\ud558\uc5ec \uacf5\uc720 \ubc0f \uc0ac\uc6a9 \uac00\ub2a5",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"shared model \uc744 freeze \ud558\uace0 Fig 1 \uc758 \ud589\ub82c ",(0,r.kt)("span",{parentName:"li",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"A")),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"A")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"A")))))," \uc640 ",(0,r.kt)("span",{parentName:"li",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"B")),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B")))))," \ub97c \uad50\uccb4\ud558\uc5ec task \ub97c \ud6a8\uc728\uc801\uc73c\ub85c \uc804\ud658"),(0,r.kt)("li",{parentName:"ul"},"\uc800\uc7a5 \uc694\uad6c\uc0ac\ud56d \ubc0f task-switching overhead \ud06c\uac8c \uc904\uc784"))),(0,r.kt)("li",{parentName:"ul"},"LoRA \ub294 adaptive optimizer \ub97c \uc0ac\uc6a9\ud560 \ub54c \ub354 \ud6a8\uc728\uc801\uc778 \ud559\uc2b5 \uac00\ub2a5 \ubc0f hardware barrier 3\ubc30 \uc904\uc784",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\ub300\ubd80\ubd84\uc758 parameter \uc5d0 \ub300\ud55c optimizer states \ub97c \uc720\uc9c0\ud558\uac70\ub098 gradient \uacc4\uc0b0 \ubd88\ud544\uc694"),(0,r.kt)("li",{parentName:"ul"},"\uc8fc\uc785\ub41c smaller low-rank matrices \ub9cc \ucd5c\uc801\ud654"))),(0,r.kt)("li",{parentName:"ul"},"\uc774 \uc124\uacc4\ub294 \uc0ac\uc6a9 \uc2dc, trainable matrices \ubc0f frozen weights \ub97c \ubcd1\ud569\ud560 \uc218 \uc788\uac8c \ud568",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"full fine-tuned model \uacfc \ube44\uad50\ud558\uc5ec, ",(0,r.kt)("em",{parentName:"li"},"inference latency \uac00 \uc5c6\uc74c")))),(0,r.kt)("li",{parentName:"ul"})))}u.isMDXComponent=!0},3574:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/image-9-f54caf106d813fc849baca1ebd70d88b.png"}}]);